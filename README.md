## poisson-reg-analysis
# Poisson Regression Analysis of the Psychiatric Situations Scale

## Background
The Psychiatric Situations Scale (PSS; Palmer et al., 2006) is a 69-item questionnaire that was developed with the intention of evaluating the comfort levels of different providers when encountering challenging situations in mental health settings regarding the patients they serve.  The questionnaire was created by 4 psychologists, 4 social workers, 4 nurses, and 1 psychiatrist.  Previous research done on this scale has reduced the inventory from 69 items to 42 items.  For the purpose of this study, I am using a 21-item version of the scale.  Each item is measured on a Likert-scale with “1” being the least amount of challenge involved and “5” being the most amount of challenge involved.  Not applicable is listed as “N/A” for questions that are irrelevent to the provider.  This will be treated as a “0” score.  Lower scores would indicate more comfort in challenging psychiatric situations.  Perhaps additional training/assistance could be given to people in the groups that tend to have more stress in an area when dealing with a patient.  The questionnaire, once completed, could prove useful in evaluating effectiveness of mental health education for providers.

## Objective
Given that the PSS (Palmer et al., 2006) is a unique scale designed specifically for use with professionals in mental health settings, little exploration has been conducted regarding the utility of this scale. Further, comparison of items in different contexts has not been thoroughly examined.  Consultation with a licensed psychologist who helped develop the PSS determined that there would be clinical meaning in combining the single-item questionnaire scores into an aggregate total PSS score (QTOTAL).  Lower total scores are indicative of providers who experience fewer challenges/distress when encountering difficult interactions with psychiatric settings, while higher scores indicate higher levels of distress in challenging situations often found in psychiatric settings.  The data (n = 116) was acquired from the original developer of the PSS. In addition to the 69 items, variables for the dataset were obtained from a demographics sheet that was administered separately from the questionnaire.  The main purpose of this research project is determining what provider demographics best predict the PSS total score.  The demographics of interest are sex (binary), age (continuous), race (categorical), site number (binary), setting worked (binary), years of education (continuous), years in mental health (continuous), occupation (categorical), relative with mental illness (binary), and hours per week worked (continuous).  

## Methods
After removing pairs of items that were negatively correlated with each other, I developed a 21-item scale with a support of [0, 105] for the response variable (Y), QTOTAL, which is the number of total points scored on the PSS.  I make the case for Y ~ Poisson(λ).  The rationale for the choice of distribution is twofold: (1) the sum of the item scores of the PSS lose the original ordinal structure of the single-item scores (e.g. a “5” on a single-item is equal to a “2” and “3” on two separate items) and (2) the values taken on are nonnegative integers.  The upper limit of the support does not approach positive infinity as would be expected for a Poisson random variable, so violating this assumption may invalidate the results to an extent.

In order to simplify factor levels and condense the ones that did not have enough replication, I converted race to a binary variable (white and other) and occupation to factor levels (1 – nurses, nurse practitioners, psychiatrists, 2 – therapists, social workers, psychologists, 3 – administrators and office staff).  To have a model that was a good fit, I removed level 3 from occupation as the primary focus of the research is on mental health and medical workers that deal with patients.

I fit the Poisson generalized linear model (GLM) with a 90/10 train-test split on the data due to the small sample size.  The train data was randomly sampled without replacement.  I planned to set the random seed to 774 but found out some random seeds caused coefficients to be linearly dependent with the intercept term in the test data, so I changed the random seed to 772.  Initially, I started from the saturated model and performed backward stepwise selection as far as possible.  I found the model deviance to be less than the critical value on the chi-square distribution at the 1% significance level (68.9446 < <img src="https://render.githubusercontent.com/render/math?math=\chi^2_{0.99,49}">  = 74.9195), making it a good model for analysis.  

First, I made predictions with the train and test data and computed the root mean square error (RMSE) for both.  I then checked the dispersion parameter to make sure it was equal to one.  The data appeared to be overdispersed, with a(Φ) ≈ 1.3847.  Using the iteratively reweighted least squares (IRWLS) algorithm, I adjusted <img src="https://render.githubusercontent.com/render/math?math=\nu(\mu)"> = <img src="https://render.githubusercontent.com/render/math?math=\mu"> to <img src="https://render.githubusercontent.com/render/math?math=\nu(\mu)"> = <img src="https://render.githubusercontent.com/render/math?math=\mu^p"> where p = 1.08 so that the variance function fell into the Poisson-Gamma Tweedie exponential distribution family such that p ∈ (1,2).  With p = 1.08, a(Φ) ≈ 0.9967.  

With the final model coefficients, I generated summary output similar to the glm() function in R and identified the significant coefficients at the 1% significance level.  I computed the RMSE for the train and test data again.  I also created two-way contingency tables to interpret the interaction terms.  The course textbook defines three types of interactions used in this project related to the log-linear Poisson GLM: nominal-by-nominal, ordinal-by-ordinal, and nominal-by-ordinal (Faraway, 2006).

## Results
In psychology, inventories like anxiety and depression commonly use a sum of item scores to determine total score cutoffs to diagnose patients.  The total score of the PSS (versus individual items) is more useful in that it creates a construct that can be described as “providers comfort with difficult psychiatric situations” (Palmer et al., 2006).  A reliability analysis of the final 21 items was conducted. Internal reliability of the questions is high (α = 0.9) suggesting that a PSS total score would measure a single construct and is justification of the choice of distribution for the response variable.

The RMSE for the train and test data before the variance was adjusted was 7.2701 points, and 20.6957 points, respectively.  After setting <img src="https://render.githubusercontent.com/render/math?math=\nu(\mu)"> = <img src="https://render.githubusercontent.com/render/math?math=\mu^1.08">, the RMSE for the train and test data was determined to be 7.2747 points and 20.7166 points, respectively.  This made sense since the second final model was supposed to account for additional variance in the response variable, QTOTAL.

There was a particular interest in scores by occupation for mental health staff (psychologists, therapists, social workers) and medical staff (nurses, nurse practitioners, and psychiatrists).  Mean predicted scores for the test data [before (<img src="https://render.githubusercontent.com/render/math?math=M_1"> = 35.1328, <img src="https://render.githubusercontent.com/render/math?math=M_2"> = 50.4096) and after (<img src="https://render.githubusercontent.com/render/math?math=M_1"> = 35.1103, <img src="https://render.githubusercontent.com/render/math?math=M_2"> = 50.4069) adjusting <img src="https://render.githubusercontent.com/render/math?math=\nu(\mu)">] followed a similar trend as the actual means of QTOTAL (<img src="https://render.githubusercontent.com/render/math?math=M_1"> = 50.6667, <img src="https://render.githubusercontent.com/render/math?math=M_2"> = 58.5000) with medical staff (occupation 1) reporting lower stress levels than mental health staff (occupation 2).

I calculated the deviance and critical values of the goodness-of-fit statistics for the interaction terms in contigency table form fit with a Poisson GLM.  Ordinal variables in these interactions were treated as continuous covariates in the Poisson regression model.  We can see that all the interactions are statistically significant at α = 0.01.

## Conclusion
The train RMSE (before and after adjusting <img src="https://render.githubusercontent.com/render/math?math=\nu(\mu)">) was much lower than the test RMSE.  These results are likely due to overfitting the model, but they could be due to an inadequate sample size.  The data was not collected with regression analysis in mind, and the scope of this project reported and the paper cited is quite different with different end goals.  

Ultimately, there was a lot of variation in the results depending on the random seed chosen due to the test sample being quite different for different seeds.  If more time was allowed, I could have attempted shuffling the samples and from the generated permutations bootstrapped more reliable estimates for the test sample.  Some random seeds were not possible to fit a model with as certain variables could be aliased rather easily with the small test sample and large amount of parameters in the model.  A Poisson response variable was not an appropriate choice for the response variable based on the random seed I chose due to overdispersion.  If a different seed had been chosen results may be different.

I hypothesized that occupation, setting worked, site, years of education, and years in mental health would be the most important demographics in predicting QTOTAL for the PSS.  With interactions involving all possible 12 main effects, I was incorrect in assuming only the above terms (and potentially their interactions) should be the ones included in the final model.

More inference on the interaction terms could have been performed, and I realize the chi-square for independence was not necessarily appropriate for some of the larger two-way tables with multiple zero counts.  Fisher’s exact test did not work for some of those tables, so the chi-square test was used both for consistency and as preferrable by the textbook.  I conclude the main effects cannot be interpreted directly as interactions involving every variable were significant.  This may lead to picking different covariates that I believe to account for these significant interactions or consider higher-order tables like partial tables to pick apart these variables more. 

## References
Faraway, J. J. (2006). Extending the linear model with R: Generalized linear, mixed effects and	nonparametric regression models.  Boca Raton: CRC Press.

Palmer G.A., Boykin A.M., Lythgoe K.O., Bizzell D.L., Daiss D.D. (2006). Mental health	professionals' perceptions of difficult psychiatric situations: A brief report on			development of the Psychiatric Situations Scale.  Internet Journal of Mental Health, E3,		[Online serial].

R Core Team (2020). R: A language and environment for statistical computing [Computer 	software]. R Foundation for Statistical Computing, Vienna, Austria. Retrieved from 	https://www.R-project.org/

Revelle, W. (2018). psych: Procedures for Personality and Psychological Research [Computer 	software, R package version 1.8.12]. Northwestern University, Evanston, Illinois, 	USA.		Retrieved from https://CRAN.R-project.org/package=psych
